# Project dev server launcher for dayta-mcp with optional port configuration

local port=""

# Parse --port option
while [[ $# -gt 0 ]]; do
    case $1 in
        --port)
            port="$2"
            shift 2
            ;;
        *)
            echo "Unknown option: $1"
            echo "Usage: dayta [--port PORT]"
            return 1
            ;;
    esac
done

# Check if already running
if pgrep -f "pnpm.*dev" | xargs ps -o command= | grep -q "dayta-mcp"; then
    echo "dayta-mcp server is already running"
    return 0
fi

# Run the dev server
cd ~/dayta-mcp || return 1
if [[ -n "$port" ]]; then
    PORT="$port" pnpm run dev
else
    pnpm run dev
fi
